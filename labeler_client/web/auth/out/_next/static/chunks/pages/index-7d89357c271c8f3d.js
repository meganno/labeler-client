(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3884)}])},3884:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var s=n(5893),i=n(2609),l=n(3640),a=n(8237),o=n(6541),c=n(1305),r=n(152),u=n(2975),d=n(6125),h=n(1823),g=n(4129),S=n(1702),m=n(6486),p=n.n(m),x=n(7294),j=n(1322),E=n.n(j),y=n(7814),N=n(3967),v=n.n(N);let w=e=>{let{icon:t,className:n=[],size:i=16,style:l={}}=e;return p().isString(n)&&(n=[n]),n.push(g.Wmm),(0,s.jsx)(y.G,{className:v()(...n),style:{width:i,height:i,...l},icon:t})};function f(e){let{ws:t,loading:n,setRegister:m,registerError:j}=e,[y,N]=(0,x.useState)(""),[v,f]=(0,x.useState)(""),[b,C]=(0,x.useState)(!1),[R,A]=(0,x.useState)(""),[k,_]=(0,x.useState)(""),[G,U]=(0,x.useState)({});(0,x.useEffect)(()=>{if(p().isEmpty(v)){U({});return}U(E()(v,["megagon","labs","444","castro","labeler",y]))},[v,y]);let B=p().get(G,"feedback.warning",""),D=p().get(G,"feedback.suggestions",[]),O=!p().isEmpty(B)||!p().isEmpty(D),W={0:i.S.DANGER,1:i.S.DANGER,2:i.S.WARNING,3:i.S.SUCCESS,4:i.S.SUCCESS},I={autoFocus:!1,enforceFocus:!1,className:"full-parent-width",placement:"right"};return(0,s.jsxs)(l.a,{children:[(0,s.jsx)(a.z,{outlined:!0,style:{marginBottom:15},onClick:()=>{m(!1)},text:"Back",icon:w({icon:S.acZ})}),(0,s.jsx)(o.c,{label:"Username",children:(0,s.jsx)(c.J,{...I,placement:"left",isOpen:p().has(j,"username"),content:(0,s.jsx)("div",{style:{padding:7.5},children:p().has(j,"username")?(0,s.jsx)(r.U,{icon:null,intent:i.S.DANGER,children:p().get(j,"username","-")}):null}),children:(0,s.jsx)(u.B,{intent:p().has(j,"username")?i.S.DANGER:null,autoFocus:!0,type:"text",value:y,onChange:e=>{N(e.target.value)}})})}),(0,s.jsxs)(o.c,{label:"Password",children:[(0,s.jsx)(c.J,{...I,isOpen:O,content:(0,s.jsxs)("div",{style:{padding:7.5,maxWidth:300},children:[p().isEmpty(B)?null:(0,s.jsxs)(r.U,{intent:i.S.DANGER,icon:null,children:[p().get(G,"feedback.warning"),"."]}),p().isEmpty(B)||p().isEmpty(D)?null:(0,s.jsx)("div",{style:{marginTop:7.5}}),p().isEmpty(D)?null:(0,s.jsx)(r.U,{icon:null,intent:i.S.WARNING,children:D.map((e,t)=>(0,s.jsx)("div",{children:e},"password-suggestion-".concat(t)))})]}),children:(0,s.jsx)(u.B,{large:!0,type:b?"text":"password",value:v,onChange:e=>{f(e.target.value)},intent:O?i.S.DANGER:null,style:{marginBottom:7.5},rightElement:(0,s.jsx)(d.u,{content:"".concat(b?"Hide":"Show"," password"),minimal:!0,placement:"bottom-end",children:(0,s.jsx)(a.z,{tabIndex:-1,minimal:!0,onClick:()=>{C(!b)},icon:w({icon:b?S._1N:S.byT})})})})}),(0,s.jsx)(h.k,{stripes:!1,intent:p().get(W,p().get(G,"score",0),null),animate:!1,value:p().get(G,"score",0)/4})]}),(0,s.jsx)(o.c,{label:"Repeat password",children:(0,s.jsx)(u.B,{large:!0,intent:p().isEmpty(R)||p().isEqual(v,R)?null:i.S.DANGER,type:"password",value:R,onChange:e=>{A(e.target.value)}})}),(0,s.jsx)(o.c,{label:"Invitation code",children:(0,s.jsx)(c.J,{...I,placement:"left",isOpen:p().has(j,"invitation_code"),content:(0,s.jsx)("div",{style:{padding:7.5},children:p().has(j,"invitation_code")?(0,s.jsx)(r.U,{icon:null,intent:i.S.DANGER,children:p().get(j,"invitation_code","-")}):null}),children:(0,s.jsx)(u.B,{type:"text",intent:p().has(j,"invitation_code")?i.S.DANGER:null,value:k,onChange:e=>{_(e.target.value)}})})}),(0,s.jsx)(a.z,{disabled:p().isNil(t)||!p().isEqual(v,R)||!p().isEmpty(B)||!p().isEmpty(D)||p().isEmpty(v),className:n?g.Ms1:null,text:"Sign up",fill:!0,onClick:()=>{t.send(JSON.stringify({username:y,password:v,invitation_code:k,action:"signup"}))},intent:i.S.PRIMARY})]})}var b=n(6527),C=n(3766);let R=b.q.create({position:C.Ly.BOTTOM});var A=n(9398),k=n(5233),_=n(9008),G=n.n(_);function U(){let[e,t]=(0,x.useState)(!0),[n,c]=(0,x.useState)(!1),[d,h]=(0,x.useState)(""),[S,m]=(0,x.useState)(""),[j,E]=(0,x.useState)(!1),[y,N]=(0,x.useState)({}),[v,w]=(0,x.useState)(null);return(0,x.useEffect)(()=>{t(!0);let e="localhost:52236",n=new WebSocket("ws://".concat(e));n.onopen=()=>{t(!1),R.show({intent:i.S.SUCCESS,message:"Connectied to client."})},n.onmessage=e=>{try{let t=JSON.parse(e.data);p().has(t,"error")?p().isEqual(p().get(t,"type",null),"register")?N(JSON.parse(t.error)):R.show({intent:i.S.DANGER,message:t.error}):p().isEqual(t,"done")&&(c(!0),n.close())}catch(t){R.show({intent:i.S.WARNING,message:e.data}),console.log(e.data),console.error(t)}},n.onerror=()=>{R.show({intent:i.S.DANGER,message:"WebSocket connection to 'ws://".concat(e,"' failed.")}),w(null),t(!1)},w(n)},[]),(0,x.useEffect)(()=>{j||N(null)},[j]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(G(),{children:[(0,s.jsx)("title",{children:"Authentication"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,s.jsx)("link",{rel:"icon",href:"/images/favicon.ico"})]}),n?(0,s.jsx)("div",{style:{padding:15},children:(0,s.jsx)(r.U,{intent:i.S.SUCCESS,children:"Authentication details received, processing details. You may close this window at any time."})}):(0,s.jsxs)(A.V,{style:{maxWidth:300,backgroundColor:k.w.WHITE},isCloseButtonShown:!1,title:"labeler-client",isOpen:!0,children:[p().isNil(v)?(0,s.jsx)(r.U,{style:{borderRadius:0},intent:i.S.DANGER,icon:null,children:"Unable to connect to client."}):null,j?(0,s.jsx)(f,{registerError:y,ws:v,loading:e,setRegister:E}):(0,s.jsxs)(l.a,{children:[(0,s.jsx)(o.c,{label:"Username",children:(0,s.jsx)(u.B,{autoFocus:!0,type:"text",value:d,onChange:e=>{h(e.target.value)}})}),(0,s.jsx)(o.c,{label:"Password",children:(0,s.jsx)(u.B,{type:"password",value:S,onChange:e=>{m(e.target.value)}})}),(0,s.jsx)(a.z,{disabled:p().isNil(v),className:e?g.Ms1:null,style:{marginBottom:20},text:"Sign in",onClick:()=>{p().isNil(v)||v.send(JSON.stringify({username:d,password:S,action:"signin"}))},fill:!0,intent:i.S.PRIMARY}),"Have an invitation code?"," ",(0,s.jsx)("a",{onClick:()=>{E(!0)},children:"Sign up"})]})]})]})}}},function(e){e.O(0,[247,130,724,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);